doctype html
html(lang="id" class="scroll-smooth")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title= title || "RegarNime - Streaming Anime Subtitle Indonesia"
    meta(name="description" content=description || "Nonton anime subtitle Indonesia terlengkap dan terbaru")
    meta(name="keywords" content="anime, streaming, subtitle indonesia, nonton anime, anime sub indo")
    link(rel="icon" href="/images/favicon.ico" onerror="this.onerror=null;this.src='https://placehold.co/400';")
    
    meta(property="og:title" content=title)
    meta(property="og:description" content=description)
    meta(property="og:type" content="website")
    meta(property="og:site_name" content="RegarNime")
    
    meta(name="twitter:card" content="summary_large_image")
    meta(name="twitter:title" content=title)
    meta(name="twitter:description" content=description)
    
    link(rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css")
    script(src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js")
    
    script(src="https://cdn.tailwindcss.com/3.4.17")
    script.
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: {
                50: '#f5f3ff',
                100: '#ede9fe',
                200: '#ddd6fe',
                300: '#c4b5fd',
                400: '#a78bfa',
                500: '#8b5cf6',
                600: '#7c3aed',
                700: '#6d28d9',
                800: '#5b21b6',
                900: '#4c1d95'
              }
            },
            fontFamily: {
              'sans': ['Inter', 'system-ui', 'sans-serif']
            }
          }
        }
      }
    
    style.
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
      
      .anime-card {
        transition: all 0.3s ease;
      }
      
      .anime-card:hover {
        transform: translateY(-4px);
      }
      
      .video-player {
        aspect-ratio: 16/9;
        background: #000;
      }
      
      .search-suggestions {
        max-height: 300px;
        overflow-y: auto;
      }
      
      .ad-slot {
        min-height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

  body(class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 font-sans transition-colors duration-300")
    header(class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50 rounded-b-lg justify-between transition-colors duration-300")
      nav(class="container mx-auto px-8 py-4")
        div(class="flex items-center justify-between")
          a(href="/" class="flex items-center")
            img(src="/images/logo.png" alt="RegarNime" class="h-8 w-auto rounded-sm", onerror="this.onerror=null;this.src='https://placehold.co/400?text=KN';")
            span(class="text-xl font-bold text-primary-600 dark:text-primary-400") KitaNime
          
          div(class="hidden md:flex items-center space-x-6")
            a(href="/" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'home' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Home
            a(href="/ongoing" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'ongoing' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Ongoing
            a(href="/complete" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'complete' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Complete
            a(href="/genres" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'genres' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Genre
            a(href="/movies" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'movies' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Movie
          
          div(class="flex-1 max-w-md mx-6 relative")
            form(action="/search" method="GET" class="relative")
              input(
                type="text" 
                name="q" 
                placeholder="Cari anime..." 
                value=keyword || ""
                class="w-full px-4 py-2 pl-10 pr-4 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors duration-200"
                autocomplete="off"
                id="searchInput"
              )
              button(type="submit" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500")
                svg(class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                  path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z")
            
            div(id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg mt-1 hidden search-suggestions z-50")
          
          div(class="flex items-center space-x-2")
            button(id="darkModeToggle" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200")
              svg(id="sunIcon" class="w-5 h-5 text-yellow-500 dark:hidden" fill="currentColor" viewBox="0 0 20 20")
                path(fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd")
              svg(id="moonIcon" class="w-5 h-5 text-gray-300 hidden dark:block" fill="currentColor" viewBox="0 0 20 20")
                path(d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z")
            
            button(id="mobileMenuBtn" class="md:hidden p-2 text-gray-600 dark:text-gray-300")
              svg(class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16")
        
        div(id="mobileMenu" class="md:hidden hidden mt-4 pb-4 border-t border-gray-200 dark:border-gray-700")
          div(class="flex flex-col space-y-3 pt-4")
            a(href="/" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'home' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Beranda
            a(href="/ongoing" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'ongoing' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Ongoing
            a(href="/complete" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'complete' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Complete
            a(href="/genres" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'genres' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Genre
            a(href="/movies" class=`text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors ${currentPage === 'movies' ? 'text-primary-600 dark:text-primary-400 font-medium' : ''}`) Movies

    if adSlots && adSlots.header && adSlots.header.length > 0
      div(class="container mx-auto px-4 py-2")
        each ad in adSlots.header
          div(class="ad-slot bg-gray-100 rounded-lg")!= ad.content

    main(class="min-h-screen")
      block content

    footer(class="bg-gray-900 dark:bg-gray-950 text-white mt-12 transition-colors duration-300")
      div(class="container mx-auto px-4 py-8")
        div(class="grid grid-cols-1 md:grid-cols-4 gap-8")
          div(class="col-span-1 md:col-span-2")
            div(class="flex items-center space-x-2 mb-4")
              img(src="/images/logo-white.png" alt="RegarNime" class="h-8 w-auto" onerror="this.onerror=null;this.src='https://placehold.co/400?text=KN';")
              span(class="text-xl font-bold") RegarNime
            p(class="text-gray-400 mb-4") Platform streaming anime subtitle Indonesia terlengkap dan terbaru. Nikmati ribuan anime berkualitas tinggi dengan subtitle Indonesia.
            div(class="flex space-x-4")
              a(href="#" class="text-gray-400 hover:text-white transition-colors")
                svg(class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24")
                  path(d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z")
              a(href="#" class="text-gray-400 hover:text-white transition-colors")
                svg(class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24")
                  path(d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z")

    if showCookieConsent
      div(id="cookieConsent" class="fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50")
        div(class="flex items-start space-x-3")
          div(class="flex-shrink-0")
            svg(class="w-5 h-5 text-primary-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24")
              path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")
          div(class="flex-1")
            p(class="text-sm text-gray-600 mb-3") Website ini menggunakan cookie untuk meningkatkan pengalaman browsing Anda.
            div(class="flex space-x-2")
              button(id="acceptCookies" class="px-3 py-1 bg-primary-600 text-white text-sm rounded hover:bg-primary-700 transition-colors") Terima
              button(id="declineCookies" class="px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors") Tolak

    script.
      const darkModeToggle = document.getElementById('darkModeToggle');
      const html = document.documentElement;
      
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        html.classList.add('dark');
      }
      
      darkModeToggle?.addEventListener('click', function() {
        html.classList.toggle('dark');
        localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
      });

      document.getElementById('mobileMenuBtn')?.addEventListener('click', function() {
        const menu = document.getElementById('mobileMenu');
        menu.classList.toggle('hidden');
      });

      const searchInput = document.getElementById('searchInput');
      const searchSuggestions = document.getElementById('searchSuggestions');
      let searchTimeout;

      searchInput?.addEventListener('input', function() {
        const query = this.value.trim();
        
        clearTimeout(searchTimeout);
        
        if (query.length < 2) {
          searchSuggestions.classList.add('hidden');
          return;
        }
        
        searchTimeout = setTimeout(() => {
          fetch(`/api/search/suggestions?q=${encodeURIComponent(query)}`)
            .then(response => response.json())
            .then(data => {
              if (data.suggestions && data.suggestions.length > 0) {
                searchSuggestions.innerHTML = data.suggestions.map(anime => 
                  `<a href="/anime/${anime.slug}" class="flex items-center space-x-3 p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0">
                    <img src="${anime.poster}" alt="${anime.title}" class="w-10 h-14 object-cover rounded" onerror="this.onerror=null;this.src='https://placehold.co/400x560?text=No+Image';">
                    <span class="text-sm font-medium text-gray-900">${anime.title}</span>
                  </a>`
                ).join('');
                searchSuggestions.classList.remove('hidden');
              } else {
                searchSuggestions.classList.add('hidden');
              }
            })
            .catch(() => {
              searchSuggestions.classList.add('hidden');
            });
        }, 300);
      });

      document.addEventListener('click', function(e) {
        if (!searchInput?.contains(e.target) && !searchSuggestions?.contains(e.target)) {
          searchSuggestions?.classList.add('hidden');
        }
      });

      document.getElementById('acceptCookies')?.addEventListener('click', function() {
        fetch('/cookie-consent', { method: 'POST' })
          .then(() => {
            document.getElementById('cookieConsent').style.display = 'none';
          });
      });

      document.getElementById('declineCookies')?.addEventListener('click', function() {
        document.getElementById('cookieConsent').style.display = 'none';
      });

    script(src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js")
    
    if adsenseEnabled
      script(async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxx" crossorigin="anonymous")
      script.
        (adsbygoogle = window.adsbygoogle || []).push({});

  block scripts
